/**
 * 한의학 한자-한글 변환 사전
 * 약재명, 처방명, 의학용어 등을 한글로 변환
 */

// ============================================
// 1. 약재명 사전 (藥材名)
// ============================================
export const HERB_DICTIONARY: Record<string, string> = {
  // ㄱ
  '甘草': '감초',
  '甘菊': '감국',
  '乾薑': '건강',
  '乾地黃': '건지황',
  '葛根': '갈근',
  '桔梗': '길경',
  '芎藭': '궁궁',
  '枸杞子': '구기자',
  '菊花': '국화',
  '橘紅': '귤홍',
  '橘皮': '귤피',
  '金銀花': '금은화',
  '桂枝': '계지',
  '桂心': '계심',
  '官桂': '관계',
  '瓜蔞': '과루',
  '瓜蔞仁': '과루인',
  '栝蔞': '괄루',
  '藿香': '곽향',

  // ㄴ
  '南星': '남성',
  '牛膝': '우슬',
  '牛黃': '우황',
  '鹿茸': '녹용',
  '鹿角': '녹각',
  '龍骨': '용골',
  '龍眼肉': '용안육',
  '龍膽': '용담',
  '龍膽草': '용담초',

  // ㄷ
  '大黃': '대황',
  '大棗': '대조',
  '當歸': '당귀',
  '桃仁': '도인',
  '獨活': '독활',
  '杜冲': '두충',
  '杜仲': '두충',

  // ㄹ
  '蘿蔔子': '나복자',
  '連翹': '연교',
  '蓮子': '연자',
  '蓮肉': '연육',
  '靈砂': '영사',

  // ㅁ
  '麻黃': '마황',
  '麻子仁': '마자인',
  '麥門冬': '맥문동',
  '麥芽': '맥아',
  '木瓜': '목과',
  '木通': '목통',
  '木香': '목향',
  '牧丹皮': '목단피',
  '牡丹皮': '모단피',
  '牡蠣': '모려',
  '沒藥': '몰약',
  '蜜': '밀',

  // ㅂ
  '半夏': '반하',
  '白朮': '백출',
  '白芍藥': '백작약',
  '白茯苓': '백복령',
  '白茯神': '백복신',
  '白芷': '백지',
  '白豆蔲': '백두구',
  '白礬': '백반',
  '白芥子': '백개자',
  '白扁豆': '백편두',
  '白蘞': '백렴',
  '貝母': '패모',
  '檳榔': '빈랑',
  '蘗皮': '벽피',
  '附子': '부자',
  '防風': '방풍',
  '防己': '방기',

  // ㅅ
  '砂仁': '사인',
  '沙蔘': '사삼',
  '山茱萸': '산수유',
  '山藥': '산약',
  '山査': '산사',
  '山梔': '산치',
  '酸棗仁': '산조인',
  '三稜': '삼릉',
  '桑白皮': '상백피',
  '桑寄生': '상기생',
  '生地黃': '생지황',
  '生薑': '생강',
  '石膏': '석고',
  '石菖蒲': '석창포',
  '細辛': '세신',
  '小茴香': '소회향',
  '蘇葉': '소엽',
  '蘇子': '소자',
  '續斷': '속단',
  '升麻': '승마',
  '柴胡': '시호',
  '神麯': '신곡',
  '辛夷': '신이',
  '芍藥': '작약',
  '赤芍藥': '적작약',
  '赤茯苓': '적복령',
  '赤小豆': '적소두',

  // ㅇ
  '五味子': '오미자',
  '五倍子': '오배자',
  '五加皮': '오가피',
  '烏梅': '오매',
  '烏藥': '오약',
  '遠志': '원지',
  '威靈仙': '위령선',
  '茵蔯': '인진',
  '茵蔯蒿': '인진호',
  '人蔘': '인삼',
  '益智仁': '익지인',
  '薏苡仁': '의이인',
  '玄胡索': '현호색',
  '玄蔘': '현삼',
  '黃芪': '황기',
  '黃芩': '황금',
  '黃連': '황련',
  '黃柏': '황백',
  '厚朴': '후박',
  '香附子': '향부자',
  '杏仁': '행인',
  '訶子': '가자',
  '阿膠': '아교',
  '艾葉': '애엽',

  // ㅈ
  '紫蘇葉': '자소엽',
  '紫草': '자초',
  '棗': '조',
  '竹茹': '죽여',
  '竹葉': '죽엽',
  '枳實': '지실',
  '枳殼': '지각',
  '知母': '지모',
  '地骨皮': '지골피',
  '眞珠': '진주',
  '秦艽': '진교',
  '澤瀉': '택사',
  '豬苓': '저령',
  '梔子': '치자',
  '蒼朮': '창출',

  // ㅊ
  '川芎': '천궁',
  '川椒': '천초',
  '天門冬': '천문동',
  '天麻': '천마',
  '天南星': '천남성',
  '天花粉': '천화분',
  '菖蒲': '창포',
  '靑皮': '청피',
  '陳皮': '진피',
  '草果': '초과',
  '草豆蔲': '초두구',
  '蔥白': '총백',
  '縮砂': '축사',

  // ㅌ
  '土茯苓': '토복령',
  '兎絲子': '토사자',
  '菟絲子': '토사자',

  // ㅍ
  '巴豆': '파두',
  '葡萄根': '포도근',
  '蒲黃': '포황',
  '皂角': '조각',
  '皂莢': '조협',

  // ㅎ
  '荷葉': '하엽',
  '夏枯草': '하고초',
  '何首烏': '하수오',
  '海藻': '해조',
  '杏仁': '행인',
  '玄胡': '현호',
  '胡椒': '호초',
  '胡桃': '호도',
  '紅花': '홍화',
  '滑石': '활석',
  '黃耆': '황기',
  '茴香': '회향',
  '薑': '강',
  '熟地黃': '숙지황',
  '肉桂': '육계',
  '肉蓯蓉': '육종용',
  '肉荳蔲': '육두구',
}

// ============================================
// 2. 처방명 사전 (處方名)
// ============================================
export const FORMULA_DICTIONARY: Record<string, string> = {
  // 가
  '加味溫膽湯': '가미온담탕',
  '加味歸脾湯': '가미귀비탕',
  '加味逍遙散': '가미소요산',
  '加味四七湯': '가미사칠탕',
  '加味大補湯': '가미대보탕',
  '葛根湯': '갈근탕',
  '甘草湯': '감초탕',
  '歸脾湯': '귀비탕',
  '桂枝湯': '계지탕',
  '交感丹': '교감단',
  '芎夏湯': '궁하탕',
  '究原心腎丸': '구원심신환',
  '古庵心腎丸': '고암심신환',

  // 나~다
  '當歸芍藥散': '당귀작약산',
  '大柴胡湯': '대시호탕',
  '大防風湯': '대방풍탕',
  '導赤散': '도적산',
  '獨活寄生湯': '독활기생탕',
  '陶氏升陽散火湯': '도씨승양산화탕',

  // 마~바
  '麻黃湯': '마황탕',
  '麥門冬湯': '맥문동탕',
  '萬金湯': '만금탕',
  '半夏瀉心湯': '반하사심탕',
  '補中益氣湯': '보중익기탕',
  '八物湯': '팔물탕',
  '八寶廻春湯': '팔보회춘탕',
  '茯苓補心湯': '복령보심탕',

  // 사
  '四君子湯': '사군자탕',
  '四物湯': '사물탕',
  '四物安神湯': '사물안신탕',
  '四七湯': '사칠탕',
  '三氣飮': '삼기음',
  '小柴胡湯': '소시호탕',
  '小續命湯': '소속명탕',
  '小青龍湯': '소청룡탕',
  '逍遙散': '소요산',
  '醒心散': '성심산',
  '雙和湯': '쌍화탕',
  '十全大補湯': '십전대보탕',
  '十六味流氣飮': '십육미유기음',

  // 아~자
  '五苓散': '오령산',
  '五積散': '오적산',
  '溫膽湯': '온담탕',
  '牛黃清心元': '우황청심원',
  '六君子湯': '육군자탕',
  '六鬱湯': '육울탕',
  '仁熟散': '인숙산',
  '人蔘逍遙散': '인삼소요산',
  '正氣天香湯': '정기천향탕',
  '芍藥甘草湯': '작약감초탕',
  '梔子淸肝湯': '치자청간탕',
  '梔子清肝湯': '치자청간탕',
  '知柏地黃湯': '지백지황탕',
  '知柏地黃丸': '지백지황환',

  // 차~하
  '天王補心丹': '천왕보심단',
  '清肝解鬱湯': '청간해울탕',
  '香砂六君子湯': '향사육군자탕',
  '香蘇散': '향소산',
  '行氣香蘇散': '행기향소산',
  '女神湯': '여신탕',
  '鹿茸大補湯': '녹용대보탕',
  '丹梔逍遙散': '단치소요산',
  '新效瓜蔞散': '신효과루산',
  '神桂香蘇散': '신계향소산',
  '地敗散': '지패산',
}

// ============================================
// 3. 의학용어 사전 (醫學用語)
// ============================================
export const MEDICAL_TERM_DICTIONARY: Record<string, { korean: string; meaning: string }> = {
  // 변증 용어
  '心膽虛㥘': { korean: '심담허겁', meaning: '심장과 담이 허약하여 쉽게 놀람' },
  '心膽虛怯': { korean: '심담허겁', meaning: '심장과 담이 허약하여 쉽게 놀람' },
  '觸事易驚': { korean: '촉사이경', meaning: '무슨 일에나 쉽게 놀람' },
  '虛煩不眠': { korean: '허번불면', meaning: '허약하고 번조하여 잠을 못 잠' },
  '夢寐不祥': { korean: '몽매불상', meaning: '꿈자리가 사나움' },
  '痰氣鬱結': { korean: '담기울결', meaning: '담과 기가 엉켜 막힘' },
  '氣血兩虛': { korean: '기혈양허', meaning: '기와 혈이 모두 허약함' },
  '肝脾不和': { korean: '간비불화', meaning: '간과 비장이 조화롭지 못함' },
  '肝鬱氣滯': { korean: '간울기체', meaning: '간의 기가 울체되어 막힘' },
  '腎陽虛': { korean: '신양허', meaning: '신장의 양기가 허약함' },
  '腎陰虛': { korean: '신음허', meaning: '신장의 음기가 허약함' },
  '脾胃虛弱': { korean: '비위허약', meaning: '소화기가 허약함' },
  '氣虛痰盛': { korean: '기허담성', meaning: '기가 허하고 담이 많음' },
  '血虛': { korean: '혈허', meaning: '혈액이 부족함' },
  '陰虛火旺': { korean: '음허화왕', meaning: '음이 부족하여 화가 성함' },
  '濕痰': { korean: '습담', meaning: '습기와 담이 결합된 병리상태' },
  '痰火': { korean: '담화', meaning: '담과 화열이 결합된 상태' },
  '怔忡': { korean: '정충', meaning: '가슴이 두근거리는 증상' },
  '驚悸': { korean: '경계', meaning: '놀라서 가슴이 뜀' },
  '健忘': { korean: '건망', meaning: '기억력 감퇴' },
  '不眠': { korean: '불면', meaning: '잠을 못 잠' },
  '多夢': { korean: '다몽', meaning: '꿈을 많이 꿈' },
  '盜汗': { korean: '도한', meaning: '잠잘 때 땀이 남' },
  '自汗': { korean: '자한', meaning: '저절로 땀이 남' },

  // 치료 원칙
  '補益': { korean: '보익', meaning: '부족한 것을 보충함' },
  '解表': { korean: '해표', meaning: '표증을 풀어줌' },
  '清熱': { korean: '청열', meaning: '열을 식힘' },
  '祛痰': { korean: '거담', meaning: '담을 제거함' },
  '理氣': { korean: '이기', meaning: '기를 다스림' },
  '理血': { korean: '이혈', meaning: '혈을 다스림' },
  '和解': { korean: '화해', meaning: '조화롭게 풀어줌' },
  '溫裏': { korean: '온리', meaning: '속을 따뜻하게 함' },
  '疏風': { korean: '소풍', meaning: '풍을 흩어줌' },
}

// ============================================
// 4. 용량 단위 사전
// ============================================
export const DOSAGE_DICTIONARY: Record<string, { korean: string; modern: string }> = {
  '錢': { korean: '전', modern: '약 3.75g' },
  '分': { korean: '푼', modern: '약 0.375g' },
  '兩': { korean: '냥', modern: '약 37.5g' },
  '斤': { korean: '근', modern: '약 600g' },
  '枚': { korean: '매', modern: '개' },
  '片': { korean: '편', modern: '조각' },
  '升': { korean: '승', modern: '약 200ml' },
  '合': { korean: '홉', modern: '약 20ml' },
  '把': { korean: '파', modern: '한 줌' },
}

// ============================================
// 5. 변환 함수들
// ============================================

/**
 * 한자 약재명을 한글로 변환
 */
export function translateHerb(hanja: string): string {
  // 직접 매칭
  if (HERB_DICTIONARY[hanja]) {
    return HERB_DICTIONARY[hanja]
  }

  // 부분 매칭 시도 (용량이 붙어있는 경우)
  for (const [cn, kr] of Object.entries(HERB_DICTIONARY)) {
    if (hanja.startsWith(cn)) {
      const remaining = hanja.slice(cn.length)
      return kr + translateDosage(remaining)
    }
  }

  return hanja // 변환 실패시 원본 반환
}

/**
 * 용량 표기를 한글로 변환
 */
export function translateDosage(text: string): string {
  let result = text
  for (const [cn, info] of Object.entries(DOSAGE_DICTIONARY)) {
    result = result.replace(new RegExp(cn, 'g'), info.korean)
  }
  // 한자 숫자 → 아라비아 숫자
  const numMap: Record<string, string> = {
    '一': '1', '二': '2', '三': '3', '四': '4', '五': '5',
    '六': '6', '七': '7', '八': '8', '九': '9', '十': '10',
    '半': '반'
  }
  for (const [cn, num] of Object.entries(numMap)) {
    result = result.replace(new RegExp(cn, 'g'), num)
  }
  return result
}

/**
 * 처방명을 한글로 변환
 */
export function translateFormula(hanja: string): string {
  return FORMULA_DICTIONARY[hanja] || hanja
}

/**
 * 의학용어를 한글+설명으로 변환
 */
export function translateMedicalTerm(hanja: string): { korean: string; meaning: string } | null {
  return MEDICAL_TERM_DICTIONARY[hanja] || null
}

/**
 * 전체 텍스트에서 한자를 한글로 변환
 */
export function translateText(text: string): string {
  let result = text

  // 처방명 변환
  for (const [cn, kr] of Object.entries(FORMULA_DICTIONARY)) {
    result = result.replace(new RegExp(cn, 'g'), kr)
  }

  // 약재명 변환
  for (const [cn, kr] of Object.entries(HERB_DICTIONARY)) {
    result = result.replace(new RegExp(cn, 'g'), kr)
  }

  // 의학용어 변환
  for (const [cn, info] of Object.entries(MEDICAL_TERM_DICTIONARY)) {
    result = result.replace(new RegExp(cn, 'g'), info.korean)
  }

  // 용량 변환
  result = translateDosage(result)

  return result
}

/**
 * 한자와 한글을 병기 (예: "當歸(당귀)")
 */
export function withKoreanReading(hanja: string): string {
  const korean = translateHerb(hanja)
  if (korean !== hanja) {
    return `${hanja}(${korean})`
  }
  return hanja
}
